<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Woody Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; }
    nav button.active { font-weight: bold; }
    .tab { display: none; padding: 1rem; }
    .tab.active { display: block; }
    .panel { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 8px; }
    .bookmark-icons { display: flex; flex-wrap: wrap; gap: 10px; }
    .bookmark-button { position: relative; display: inline-block; }
    .bookmark-button img { width: 32px; height: 32px; }
    .remove { position: absolute; top: -8px; right: -8px; background: red; color: white; border-radius: 50%; padding: 0 4px; cursor: pointer; }
    .quick-comments { display: flex; flex-wrap: wrap; gap: 10px; }
    .quick-comment-button { padding: 5px 10px; }
    .dark .panel { background: #333; color: white; }
    .dark body { background: #111; color: white; }
    .dark-toggle { float: right; margin: 10px; }
    .notes-panel textarea { width: 100%; min-height: 100px; }
  </style>
</head>
<body>
   <div class="hero-background">
     <div class="top-left">
        <nav>
          <button data-tab="work" class="active">Work</button>
          <button data-tab="personal">Personal</button>
          <button data-tab="secondjob">ADI</button>
          <button data-tab="charity">Table/41</button>
        </nav>
      </div>
      <div class="top-right">
        <div class="dark-toggle">
          <label class="switch">
            <input type="checkbox" id="darkModeToggle" />
            <span class="slider"></span>
          </label>
          <span id="theme-label">ðŸŒž</span>
        </div>
        <div class="panel small-clocks" id="side-world-clocks">
          <h4>World Clocks</h4>
          <div id="world-clocks-work"></div>
        </div>
      </div>
      <div class="dashboard-title">Woody</div>
    </div>

  <!-- === TAB: WORK === -->
  <div id="work" class="tab active">
    <h2>Work</h2>

    <div class="utility-panels">
      <div class="panel" id="bookmarks-panel-work">
        <h3>Bookmarks</h3>
        <div id="bookmark-bar-work" class="bookmark-bar"></div>
        <button class="addBookmarkBtn" onclick="openBookmarkModal('work')">âž• Add Bookmark</button>
      </div>

      <div class="panel" id="quick-comments-panel-work">
        <h3>Quick Comments</h3>
        <div id="quick-comments-work" class="quick-comments"></div>
        <button class="addCommentBtn" data-tab="work">âž• Add Comment</button>
      </div>
    </div>

    <!-- Modal -->
    <div id="bookmarkModal-work" class="modal" style="display:none;">
      <div class="modal-content">
        <span class="close" onclick="closeBookmarkModal('work')">&times;</span>
        <h3>Add Bookmark</h3>
        <input type="url" id="newBookmarkUrl-work" placeholder="https://example.com" />
        <button onclick="addBookmark('work')">Save</button>
      </div>
    </div>

    <div class="notes-panel">
      <h3>Work Notes</h3>
      <textarea id="notes-work" rows="6" placeholder="Work notes..."></textarea><br/>
      <button onclick="saveNotes('work')">Save</button>
      <span id="saveStatus-work"></span>
    </div>
  </div>

 <!-- === TAB: PERSONAL === -->
<div id="personal" class="tab">
  <h2>Personal</h2>
  <h3>Bookmarks</h3>
  <div id="bookmark-bar-personal" class="bookmark-bar"></div>
  <button id="showBookmarkModal-personal" style="margin-top: 10px;">âž• Add Bookmark</button>
<h3>Quick Comments</h3>
  <div id="quick-comments-personal" class="quick-comments"></div>
  <button class="addCommentBtn" data-tab="personal">âž• Add Comment</button>
  
<!-- Modal -->
  <div id="bookmarkModal-personal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" onclick="closeBookmarkModal('personal')">&times;</span>
      <h3>Add Bookmark</h3>
      <input type="url" id="newBookmarkUrl-personal" placeholder="https://example.com" />
      <button onclick="addBookmark('personal')">Save</button>
    </div>
  </div>

  <div class="notes-panel">
    <h3>Personal Notes</h3>
    <textarea id="notes-personal" rows="6" placeholder="Personal notes..."></textarea><br/>
    <button onclick="saveNotes('personal')">Save</button>
    <span id="saveStatus-personal"></span>
  </div>
</div>

<!-- === TAB: ADI === -->
<div id="secondjob" class="tab">
  <h2>ADI</h2>
  <h3>Bookmarks</h3>
  <div id="bookmark-bar-secondjob" class="bookmark-bar"></div>
  <button id="showBookmarkModal-secondjob" style="margin-top: 10px;">âž• Add Bookmark</button>
<h3>Quick Comments</h3>
  <div id="quick-comments-secondjob" class="quick-comments"></div>
  <button class="addCommentBtn" data-tab="secondjob">âž• Add Comment</button>
<div id="secondjob-alarm">
  <div id="alarm-countdown" class="led green">00:00</div>
  <label>
    Frequency (seconds):
    <input type="number" id="alarm-frequency" min="1" value="120">
  </label>
  <label>
    <input type="checkbox" id="alarm-random"> Randomize Â±10%
  </label>
  <button id="alarm-start">Start Alarm</button>
  <button id="alarm-stop">Stop Alarm</button>
</div>
  <!-- Modal -->
  <div id="bookmarkModal-secondjob" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" onclick="closeBookmarkModal('secondjob')">&times;</span>
      <h3>Add Bookmark</h3>
      <input type="url" id="newBookmarkUrl-secondjob" placeholder="https://example.com" />
      <button onclick="addBookmark('secondjob')">Save</button>
    </div>
  </div>
  <div class="notes-panel">
    <h3>ADI Notes</h3>
    <textarea id="notes-secondjob" rows="6" placeholder="ADI notes..."></textarea><br/>
    <button onclick="saveNotes('secondjob')">Save</button>
    <span id="saveStatus-secondjob"></span>
  </div>
</div>

<!-- === TAB: CHARITY === -->
<div id="charity" class="tab">
  <h2>Charity</h2>
  <h3>Bookmarks</h3>
    <div id="bookmark-bar-charity" class="bookmark-bar"></div>
    <button id="showBookmarkModal-charity" style="margin-top: 10px;">âž• Add Bookmark</button>
  <h3>Quick Comments</h3>
    <div id="quick-comments-charity" class="quick-comments"></div>
    <button class="addCommentBtn" data-tab="charity">âž• Add Comment</button>

  <!-- Modal -->
  <div id="bookmarkModal-charity" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close" onclick="closeBookmarkModal('charity')">&times;</span>
      <h3>Add Bookmark</h3>
      <input type="url" id="newBookmarkUrl-charity" placeholder="https://example.com" />
      <button onclick="addBookmark('charity')">Save</button>
    </div>
  </div>

  <div class="notes-panel">
    <h3>Charity Notes</h3>
    <textarea id="notes-charity" rows="6" placeholder="Charity notes..."></textarea><br/>
    <button onclick="saveNotes('charity')">Save</button>
    <span id="saveStatus-charity"></span>
  </div>
</div>
<div id="bookmark-context-menu" class="context-menu">
  <ul>
    <li data-action="open">Open in New Tab</li>
    <li data-action="copy">Copy URL</li>
    <li data-action="edit">Edit Bookmark</li>
    <li data-action="remove">Remove Bookmark</li>
    <li data-action="change-favicon">Change Favicon</li>
  </ul>
</div>

<input type="file" id="favicon-upload" style="display:none" accept="image/*" />
  <!-- === SCRIPT === -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const app = initializeApp({
      apiKey: "...",
      authDomain: "...",
      projectId: "...",
    });

    const db = getFirestore(app);

    async function saveNotes(tab) {
      const content = document.getElementById(\`notes-\${tab}\`).value;
      await setDoc(doc(db, "dashboardNotes", tab), { content });
      document.getElementById(\`saveStatus-\${tab}\`).textContent = "âœ” Saved!";
    }

    async function loadNotes(tab) {
      const snap = await getDoc(doc(db, "dashboardNotes", tab));
      if (snap.exists()) {
        document.getElementById(\`notes-\${tab}\`).value = snap.data().content;
      }
    }

    async function loadBookmarks(tab) {
      const snap = await getDoc(doc(db, "dashboardBookmarks", tab));
      const container = document.getElementById(\`bookmark-bar-\${tab}\`);
      container.innerHTML = "";
      if (snap.exists()) {
        for (const url of snap.data().urls || []) {
          const img = document.createElement("img");
          img.src = "https://www.google.com/s2/favicons?domain=" + new URL(url).hostname;
          img.style.width = "32px";
          img.style.height = "32px";
          const a = document.createElement("a");
          a.href = url;
          a.target = "_blank";
          a.appendChild(img);
          container.appendChild(a);
        }
      }
    }

    async function addBookmark(tab) {
      const input = document.getElementById(\`newBookmarkUrl-\${tab}\`);
      const url = input.value;
      const snap = await getDoc(doc(db, "dashboardBookmarks", tab));
      const data = snap.exists() ? snap.data() : { urls: [] };
      if (!data.urls.includes(url)) {
        data.urls.push(url);
        await setDoc(doc(db, "dashboardBookmarks", tab), data);
        loadBookmarks(tab);
        input.value = "";
      }
    }

    async function loadQuickComments(tab) {
      const snap = await getDoc(doc(db, "quickComments", tab));
      const container = document.getElementById(\`quick-comments-\${tab}\`);
      container.innerHTML = "";
      if (snap.exists()) {
        for (const item of snap.data().comments || []) {
          const btn = document.createElement("button");
          btn.textContent = item.label;
          btn.className = "quick-comment-button";
          btn.onclick = () => navigator.clipboard.writeText(item.text);
          container.appendChild(btn);
        }
      }
    }

    document.querySelectorAll('nav button').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.getElementById(btn.dataset.tab).classList.add('active');
        btn.classList.add('active');
      };
    });

    const tabs = ["work", "personal", "secondjob", "charity"];
    tabs.forEach(tab => {
      loadNotes(tab);
      loadBookmarks(tab);
      loadQuickComments(tab);
    });

    const toggle = document.getElementById("darkModeToggle");
    toggle.addEventListener("change", () => {
      document.body.classList.toggle("dark", toggle.checked);
    });
  </script>

</body>
</html>
